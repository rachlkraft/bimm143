---
title: "class6 functions"
author: "Rachel Kraft"
date: "2/6/2022"
output: pdf_document
---


introduction to R functions/writing them

> Q1) Write a function grade() to determine an overall grade from a vector of student homework
assignment scores dropping the lowest single score. If a student misses a homework (i.e. has an
NA value) this can be used as a score to be potentially dropped. Your final function should be
adquately explained with code comments and be able to work on an example class gradebook
such as this one in CSV format: “https://tinyurl.com/gradeinput

```{r}
# Example input vectors to start with
student1 <- c(100, 100, 100, 100, 100, 100, 100, 90)
student2 <- c(100, NA, 90, 90, 90, 90, 97, 80)
student3 <- c(90, NA, NA, NA, NA, NA, NA, NA)
```

- find lowest score

```{r}
student1 <- c(100, 100, 100, 100, 100, 100, 100, 90)

#tells which vector element is the lowest
which.min(student1)  
```
- drop lowest score

```{r}
# returns everything but the 8th element from student 1
student1[-8]
```
- use answer from which.min() to return all other vector elements besides lowest, then can take the mean

```{r}
#first working part of code for question 1
mean(student1[-which.min(student1)])
```
will this work for other students?

can try na.rm=TRUE for mean, but not a good approach

```{r}
student2 <- c(100, NA, 90, 90, 90, 90, 97, 80)
mean(student2, na.rm=TRUE)

student3 <- c(90, NA, NA, NA, NA, NA, NA, NA)
mean(student3, na.rm=TRUE)
```
mask (replace) the NAs with zero

- first find NA elements

```{r}
student2 <- c(100, NA, 90, 90, 90, 90, 97, 80)
x <- student2

is.na(x)
which(is.na(x))
```
now have identified NA elements that we want to mask and replace with 0

```{r}
x[is.na(x)] <- 0
x
mean(x)
```

still need to drop lowest score

```{r}
x[is.na(x)] <- 0
mean(x[-which.min(x)])
```

try for student 3
- here is the working code
```{r}
student3 <- c(90, NA, NA, NA, NA, NA, NA, NA)
x <- student3
x[is.na(x)] <- 0
mean(x[-which.min(x)])
```

##Now make the function

take code from above and turn into a function
need:
- name 'grade()'
- input arguments, vector of student scores
- body (our code)

select 'Code > Extract Function'

```{r}
grade <- function(x) {
  x[is.na(x)] <- 0
  mean(x[-which.min(x)])
}
```

test

```{r}
grade(student1)
grade(student2)
grade(student3)
```

Comments to explain this code for any future users:
- insert Roxygen skeleton

```{r}
#' Calculate the average score, after dropping the lowest, for a vector of student scores. Missing scores are treated as zero.
#'
#' @param x This is a numeric vector of student homework scores
#'
#' @return Average score
#' @export
#'
#' @examples
#' student <- c(100, 80, NA, 92)
#' grade(student)
#' 
  
grade <- function(x) {
  #Treat missing scores as zero, instead of NA
    x[is.na(x)] <- 0
    #Drop the lowest score and take the mean of all other       values
    mean(x[-which.min(x)])
  }
```

Now, use the grade() function on whole class data from question 1. use read.csv() to read the csv gradebook file
  https://tinyurl.com/gradeinput
  
```{r}
url <- "https://tinyurl.com/gradeinput"
gradebook <- read.csv(url, row.names=1)
```

use apply() function to work with data frame inputs

```{r}
apply(gradebook, 1, grade)
```


> Q2) Using your grade() function and the supplied gradebook, Who is the top scoring student
overall in the gradebook? 

Run the apply() function and save the results

```{r}
results <- apply(gradebook, 1, grade)
sort(results, decreasing=TRUE)
```

Find the student with the highest average

```{r}
which.max(results)
```

> Q3)  From your analysis of the gradebook, which homework was toughest on students (i.e. obtained the lowest scores overall?

```{r}
gradebook
```

check by average per column

```{r}
ave.scores <- apply(gradebook, 2, mean, na.rm=TRUE)
ave.scores
which.min(ave.scores)
```
- hw 3 is the worst 

check by median per column

```{r}
med.scores <- apply(gradebook, 2, median, na.rm=TRUE)
med.scores
which.min(med.scores)
```
- hw 2 is the worst

best way? use a boxplot

```{r}
boxplot(gradebook)
```

> Q4) Optional

> Q5) Make sure you save your Rmarkdown document and can click the “Knit” button to generate
a PDF foramt report without errors. Finally, submit your PDF to gradescope

Knit the document to make a PDF


