---
title: "lab10r"
author: "Rachel Kraft"
date: "2/19/2022"
output: pdf_document
---

> Section 1

> 5) Proportion of G/G in population

- download the CSV, read

```{r}
mxl <- read.csv("373531-SampleGenotypes-Homo_sapiens_Variation_Sample_rs8067378.csv")

table(mxl$Genotype..forward.strand.)
```

```{r}
table(mxl$Genotype..forward.strand.) / nrow(mxl) *100
```

> Section 4

> One sample is obviously not enough to know what is happening in a population. You are interested in assessing genetic differences on a population scale. So, you processed about ~230 samples and did the normalization on a genome level. Now, you want to find whether there is any association of the 4 asthma-associated SNPs (rs8067378â€¦) on ORMDL3 expression.

> 13) Read this file into R and determine the sample size for each genotype and their corresponding median expression levels for each of these genotypes

read dataset

```{r}
expr <- read.table("rs8067378_ENSG00000172057.6.txt")
head(expr)
```

how many samples of each genotype?

```{r}
table(expr$geno)
```

108 samples for AA, 233 for AG, 121 for GG

to find median expression levels, save output of boxplot() to an R object

```{r}
bp <- boxplot(exp~geno, data=expr)
# stats to give 5 number summary for the boxplot
bp$stats
# medians are in row 3
bp$stats[3,]
```

for AA (column 1), median expression level is 31.24847
for AG (column 2), median expression level is 25.06486
for GG (column 3), median expresison level is 20.07363


>14) Generate a boxplot with a box per genotype, what could you infer from the relative expression value between A/A and G/G displayed in this plot? Does the SNP effect the
expression of ORMDL3?

```{r}
library(ggplot2)
```

boxplot for this data, genotype vs expression level to show the median expression level for each genotype 

```{r}
ggplot(expr)+aes(geno, exp, fill=geno)+geom_boxplot(notch=TRUE)
```

From this plot, there is definitely less expression of ORMDL3 in individuals with the homozygous GG genotype opposed to AA. Yes, the SNP decreases expression of ORMDL3.

